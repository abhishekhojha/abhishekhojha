---
// src/layouts/menu.astro
import { Github, Moon, Sun, Download } from "lucide-react";
const currentPath = Astro.url.pathname;
---

{/* ── Top bar ─────────────────────────────────────────────────────── */}
<div
  class="fixed w-full top-0 z-50 px-3 sm:px-4 py-4 md:py-6 pointer-events-none"
>
  <div
    class="container mx-auto flex justify-center md:justify-between items-center"
  >
    {/* Main Navigation */}
    <nav
      class="pointer-events-auto flex items-center gap-1 sm:gap-4 rounded-full px-2 sm:px-3 py-1.5 sm:py-2 bg-white/70 dark:bg-gray-900/70 backdrop-blur-xl border border-white/40 dark:border-gray-700/40 shadow-[0_8px_32px_rgba(0,0,0,0.04)] dark:shadow-[0_8px_32px_rgba(0,0,0,0.3)] ring-1 ring-gray-900/5 dark:ring-white/5 transition-all duration-500"
    >
      <a
        href="/"
        class:list={[
          "relative px-2 sm:px-4 py-1.5 text-sm font-semibold rounded-full transition-all duration-300 whitespace-nowrap",
          currentPath === "/"
            ? "text-gray-900 dark:text-white bg-gray-900/5 dark:bg-white/10"
            : "text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-900/5 dark:hover:bg-white/10",
        ]}>Home</a
      >
      <a
        href="/projects"
        class:list={[
          "relative px-2 sm:px-4 py-1.5 text-sm font-semibold rounded-full transition-all duration-300 whitespace-nowrap",
          currentPath.startsWith("/projects")
            ? "text-gray-900 dark:text-white bg-gray-900/5 dark:bg-white/10"
            : "text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-900/5 dark:hover:bg-white/10",
        ]}>Projects</a
      >
      <a
        href="/learnings"
        class:list={[
          "relative px-2 sm:px-4 py-1.5 text-sm font-semibold rounded-full transition-all duration-300 whitespace-nowrap",
          currentPath.startsWith("/learnings")
            ? "text-gray-900 dark:text-white bg-gray-900/5 dark:bg-white/10"
            : "text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white hover:bg-gray-900/5 dark:hover:bg-white/10",
        ]}>Learnings</a
      >
      <a
        href="/#contact"
        class="relative px-2 sm:px-4 py-1.5 text-sm font-semibold text-gray-600 dark:text-gray-400 rounded-full transition-all duration-300 hover:text-gray-900 dark:hover:text-white hover:bg-gray-900/5 dark:hover:bg-white/10 whitespace-nowrap"
        >Contact</a
      >
    </nav>

    {
      /* Right section — visible on sm+ only (hidden on mobile, shown in bottom bar instead) */
    }
    <div class="pointer-events-auto hidden sm:flex items-center gap-2">
      <a
        href="https://github.com/abhishekhojha"
        target="_blank"
        rel="noopener noreferrer"
        aria-label="GitHub profile"
        class="inline-flex items-center justify-center w-9 h-9 rounded-full text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white bg-white/70 dark:bg-gray-900/70 border border-white/40 dark:border-gray-700/40 backdrop-blur-xl shadow-[0_8px_32px_rgba(0,0,0,0.04)] dark:shadow-[0_8px_32px_rgba(0,0,0,0.3)] transition-all duration-300"
      >
        <Github className="w-[15px] h-[15px]" strokeWidth={2} />
      </a>
      <button
        id="theme-toggle"
        aria-label="Toggle dark mode"
        class="inline-flex items-center justify-center w-9 h-9 rounded-full bg-white/70 dark:bg-gray-900/70 border border-white/40 dark:border-gray-700/40 backdrop-blur-xl shadow-[0_8px_32px_rgba(0,0,0,0.04)] dark:shadow-[0_8px_32px_rgba(0,0,0,0.3)] text-gray-600 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-all duration-300"
      >
        <Sun className="hidden dark:block w-[15px] h-[15px]" strokeWidth={2} />
        <Moon className="block dark:hidden w-[15px] h-[15px]" strokeWidth={2} />
      </button>
      <a
        href="/ABHISHEKH_OJHA.pdf"
        download="ABHISHEKH_OJHA.pdf"
        aria-label="Download Resume"
        class="group inline-flex items-center justify-center gap-2 px-5 py-2 h-9 font-bold text-sm text-white dark:text-gray-900 bg-gray-900 dark:bg-white rounded-full shadow-lg hover:shadow-xl hover:-translate-y-0.5 transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-900 dark:focus:ring-white"
      >
        <span class="tracking-wide">Resume</span>
      </a>
    </div>
  </div>
</div>

{/* ── Mobile bottom bar — visible only on mobile (hidden sm+) ─────── */}
<div
  class="sm:hidden fixed bottom-0 left-0 right-0 z-50 px-4 pb-3 pointer-events-none"
>
  <div
    class="pointer-events-auto flex items-center justify-around rounded-2xl px-4 py-2 bg-white/80 dark:bg-gray-900/80 backdrop-blur-xl border border-white/40 dark:border-gray-700/40 shadow-[0_-4px_24px_rgba(0,0,0,0.07)] dark:shadow-[0_-4px_24px_rgba(0,0,0,0.35)]"
  >
    {/* GitHub */}
    <a
      href="https://github.com/abhishekhojha"
      target="_blank"
      rel="noopener noreferrer"
      aria-label="GitHub profile"
      class="inline-flex items-center justify-center w-9 h-9 rounded-full text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors duration-200"
    >
      <Github className="w-[18px] h-[18px]" strokeWidth={2} />
    </a>

    {/* Theme toggle */}
    <button
      id="theme-toggle"
      aria-label="Toggle dark mode"
      class="inline-flex items-center justify-center w-9 h-9 rounded-full text-gray-500 dark:text-gray-300 hover:text-gray-900 dark:hover:text-white transition-colors duration-200"
    >
      <Sun className="hidden dark:block w-[18px] h-[18px]" strokeWidth={2} />
      <Moon className="block dark:hidden w-[18px] h-[18px]" strokeWidth={2} />
    </button>

    {/* Resume download */}
    <a
      href="/ABHISHEKH_OJHA.pdf"
      download="ABHISHEKH_OJHA.pdf"
      aria-label="Download Resume"
      class="inline-flex items-center justify-center w-9 h-9 rounded-full text-gray-500 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors duration-200"
    >
      <Download className="w-[18px] h-[18px]" strokeWidth={2} />
    </a>
  </div>
</div>

<script>
  function initThemeToggle() {
    // There can be two toggles (top bar desktop + bottom bar mobile) — handle both
    document.querySelectorAll("#theme-toggle").forEach((btn) => {
      const fresh = btn.cloneNode(true) as HTMLElement;
      btn.replaceWith(fresh);
      fresh.addEventListener("click", () => {
        const isDark = document.documentElement.classList.toggle("dark");
        localStorage.setItem("theme", isDark ? "dark" : "light");
      });
    });
  }
  document.addEventListener("astro:page-load", initThemeToggle);
</script>
